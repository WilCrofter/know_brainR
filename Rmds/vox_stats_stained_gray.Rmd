---
title: "Voxel level statistics for stained gray matter"
author: "W. Bauer"
date: "June 6, 2015"
output: html_document
---

```{r echo=FALSE}
source("../R/utilities.R")
source("../R/alpha.R")
```

[Earlier](voxel_level_stats.html) probabilities of scattering, absorption, and encountering a boundary were estimated for voxels of the 11 BrainWeb tissue types. This note estimates corresponding statistics for stained gray matter using the same approach.

The absorption coefficient of stained gray matter will be the sum of $\mu_a \approx 0.0335\:mm^{-1},$ the absorption coefficient, $\mu_{a.dye},$ of the stain. The stain's coefficient will depend on two things, its concentration and the local extent of depolarization. A 1 micromolar concentration of dye [was estimated] to have about the same absorption coefficient as gray matter itself. Depolarization might reduce that by as much as 30%.

Concentrations of 5 micromolars may not be unreasonable, so I'll estimate statistics for 14 concentrations ranging from 2/3 to 5 micromolars by thirds. We've previously estimated a (full, not reduced) scattering coefficient of $\mu_s \approx 10\:mm^{-1}$ for gray matter. Staining should not affect it.

Following the procedure in [Voxel Level Statistics](voxel_level_stats.html),

```{r eval=FALSE}
ranseed <- 1433640632 # system time when code was written
cnctr <- seq(2/3, 5, by=1/3) # concentrations
scatter <- data.frame(id=21:34, 
                      tissue = paste(signif(cnctr,2), "umolar"),
                      mu_a = (1+cnctr)*0.0335,
                      mu_s = 10,
                      p_scatter=NA, std_err_scatter=NA)
for(i in 1:14){
  mua <- scatter[i, "mu_a"]
  mus <- scatter[i, "mu_s"]
  temp <- pscatter(mua,mus,1e+6,ranseed+i)
  scatter[i, "p_scatter"] <- temp$prscatt
  scatter[i, "std_err_scatter"] <- temp$se_scatt
}

scatter
```

```{r echo=FALSE, fig.align='center, fig.show='hold'}
scatter <- read.table("../data/pscatter_stained_gray.csv", sep=",", header=TRUE)
scatter
cnctr <- seq(2/3, 5, by=1/3) # concentrations
plot(cnctr, scatter$p_scatter, xlab="VSD concentration (micromolar)", ylab="Scattering probability", main="Probability of scattering as opposed to absorption\nor encountering a boundary", pch=19, col='blue')
mdl <- lm(scatter$p_scatter ~ cnctr)
abline(mdl, lwd=3, lty=2, col='blue')
text(3, .857, expression(P(scatter) %~~% 0.86 - 0.002412 %*% concentration), cex=1.25)
```
